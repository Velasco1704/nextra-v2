# name: build-test-deploy
# on:
#   push:
#     branches:
#       - main

# jobs:
#   build:
#     runs-on: ubuntu-latest
#     steps:
#       - name: Checkout Repo
#         uses: actions/checkout@v4
#         with:
#           repository: Velasco1704/docs-example
#       - name: use node.js
#         uses: actions/setup-node@v4
#         with:
#           node-version: "18.x"
#       - run: npm i
#       - run: npm run build

#   aws-publish:
#     needs: build
#     runs-on: ubuntu-latest
#     steps:
#       - name: checkout repo
#         uses: actions/checkout@v4
#       - name: use node.js
#         uses: actions/setup-node@v4
#         with:
#           node-version: "18.x"
#       - run: npm i
#       - run: npm install -g pnpm
#       - run: npm install -g @aws-amplify/cli
#       - name: Configurar AWS credentials
#         uses: aws-actions/configure-aws-credentials@v1
#         with:
#           aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
#           aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
#           aws-region: us-east-1
#       - run: amplify init --appId d298pyf9b3b3j0 --envName staging -y
#       - run: amplify publish -y

name: Build and Publish

on:
  push:
    branches:
      - main
  repository_dispatch:
    types: [docs-example]

jobs:
  aws-publish:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout App Repo
        uses: actions/checkout@v4
      - name: Checkout Docs Repo
        uses: actions/checkout@v4
        with:
          repository: Velasco1704/docs-example
          path: docs-example
      - name: Use Node.js
        uses: actions/setup-node@v4
        with:
          node-version: "18.x"
      - run: npm i
      - run: npm install -g pnpm
      - run: npm install -g @aws-amplify/cli
      - name: Configurar AWS credentials
        uses: aws-actions/configure-aws-credentials@v1
        with:
          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
          aws-region: us-east-1
      - run: amplify init --appId d298pyf9b3b3j0 --envName staging -y
      - run: amplify publish -y
